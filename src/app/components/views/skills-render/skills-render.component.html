@let hero = selectedHero();
@let _showLabel = showLabel();
@let _showSkillName = showSkillName();
@let _showAsBackground = showAsBackground();
@let _imageCoverClass = imageCoverClass();
@let _sliderMode = sliderMode();
@let _placeholderConfig = placeholderConfig();
@let _containerPaddingClasses = containerPaddingClasses();
@let _convertTextToLowercase = convertTextToLowercase();
@let _renderBySentence = renderBySentence();
@let _label = label();

@let _storesInnerDivClass = storesInnerDivClass();

<div class="skills-container" [class]="_containerPaddingClasses">
  <app-basic-stores-placeholder
    [title]="_showLabel ? _label : ''"
    [innerDivClass]="_storesInnerDivClass"
    [config]="_placeholderConfig">
    <ng-container ngProjectAs="header-icon">
      <ng-content select="slider-mode-content" />
    </ng-container>

    @if (_sliderMode) {
      <mat-tab-group class="skills-tabs">
        @for (skill of hero.skills; track skill.name + $index) {
          <mat-tab [label]="skill.name">
            <ng-container
              [ngTemplateOutlet]="skillBar"
              [ngTemplateOutletContext]="{ skill, showImage: false }" />
          </mat-tab>
        }
      </mat-tab-group>
    } @else {
      @for (skill of hero.skills; track skill.name + $index) {
        <ng-container
          [ngTemplateOutlet]="skillBar"
          [ngTemplateOutletContext]="{ skill, showImage: true }" />
      }
    }
  </app-basic-stores-placeholder>
</div>

<ng-template #skillBar let-skill="skill" let-showImage="showImage">
  <div class="skill-container p-1 cursor-unset row g-2 m-0 ignore-direction align-items-stretch">
    @if (showImage) {
      <div class="col-auto mt-0">
        <div
          style="width: fit-content; height: 100%"
          [class]="_imageCoverClass"
          [ngClass]="{
            'dynamic-border': skill.passive,
          }">
          <app-image
            [source]="skill.imgSrc"
            [alt]="skill.name"
            [renderAsBackground]="_showAsBackground" />
        </div>
      </div>
    }
    <div class="col mt-0">
      <app-effects-highlighter
        [text]="skill.description"
        [renderBySentence]="_renderBySentence"
        [convertTextToLowercase]="_convertTextToLowercase">
        @if (_showSkillName) {
          <p class="mb-1">
            <b class="defence-color"> {{ skill.name }} {{ skill.passive ? '( P )' : '' }} </b>
          </p>
        }
      </app-effects-highlighter>
    </div>
  </div>
</ng-template>
