<div class="page-container">
  <app-page-loader [loader]="loader" />

  <div class="row ms-2 me-2 mb-2 g-2">
    <div class="col-lg-6 col-sm-12">
      <app-stats [selectedHero]="selectedHero"></app-stats>
    </div>
    <div class="col-lg-6 col-sm-12">
      <app-skills-render
        [selectedHero]="selectedTileHero"
        [containerPaddingClasses]="''"
        [showLabel]="true"
        [showSkillName]="true"></app-skills-render>
    </div>
  </div>
  <div class="p-2">
    <mat-tab-group>
      @for (boss of config; track boss.level) {
        <mat-tab>
          <ng-template mat-tab-label>
            {{ boss.heading }}
          </ng-template>
          <ng-container
            [ngTemplateOutlet]="bossTemplate"
            [ngTemplateOutletContext]="{ bossLevel: boss.level }"></ng-container>
        </mat-tab>
      }
    </mat-tab-group>
  </div>

  <ng-template #bossTemplate let-bossLevel="bossLevel">
    <div class="p-3">
      <div class="col-12">
        <app-stats [selectedHero]="upBoss(bossLevel)" [tableMode]="true">
          @let bossConfig = bossReward(bossLevel);

          <div class="skills-container ps-2 pe-2">
            <div class="d-flex rewards-bar h-100 align-items-center">
              <img
                src="assets/resourses/imgs/icons/silver_chest.jpeg"
                alt="silver_chest"
                height="125px" />
              <div class="ps-2">
                @for (bossConfigReward of bossConfig; track $index) {
                  <p class="mb-0">
                    <span [class]="bossConfigReward.alias">
                      {{ bossConfigReward.base | number }} (+{{ bossConfigReward.win | number }}
                      kill reward )
                    </span>
                    <img
                      [src]="`assets/resourses/imgs/${bossConfigReward.alias}.png`"
                      [alt]="bossConfigReward.alias" />
                    for every
                    <span class="highlight-effect">{{ bossConfigReward.dmg | number }}</span>
                    DMG.
                  </p>
                }
              </div>
            </div>
          </div>
        </app-stats>
      </div>
      <div class="flex-wrap">
        <app-heroes-select
          [allHeroes]="allUnitsForSelect"
          [isUser]="true"
          [contextName]="heroesContext"
          [containerClass]="'border-radius-none border-end-0'"
          [addUserUnit]="addUserUnit"></app-heroes-select>
        @if (chosenUnits.length) {
          <app-heroes-select-preview
            [units]="chosenUnits"
            [containerClass]="'border-radius-none border-end-0'"></app-heroes-select-preview>
        }
      </div>
      <div class="row mt-2 g-2">
        <div class="col-8">
          <button class="w-100 got-toggle" (click)="goToMainPage()">Back to Castle Back</button>
        </div>
        <div class="col-4">
          <button class="w-100 got-toggle got-toggle-red" (click)="openFight(bossLevel)">
            Fight
          </button>
        </div>
      </div>
    </div>
  </ng-template>
</div>
