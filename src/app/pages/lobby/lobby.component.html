<div class="lobby-container container-fluid">
  <main class="row mt-4 g-2">
    <aside class="col-sm-12 col-md-6 shadow-none">
      <app-basic-stores-placeholder title="Routes">
        <mat-list class="pt-0 pb-0">
          @for (route of pageRoutes; track route.name) {
            <mat-list-item class="position-relative">
              <a [routerLink]="route.url" class="list-group-item" mat-line>
                <span class="d-flex">
                  <app-image
                    [source]="'assets/resourses/imgs/nav_icons/' + route.src"
                    [alt]="route.name"></app-image>
                  {{ route.name }}
                </span>
              </a>

              @if (!$last) {
                <mat-divider [inset]="true"></mat-divider>
              }

              @if (route.closed) {
                <app-container-label [size]="25" class="color-white" />
              }
            </mat-list-item>
          }
          <mat-divider></mat-divider>
        </mat-list>
      </app-basic-stores-placeholder>
    </aside>

    <div class="col-sm-12 col-md-6">
      <app-basic-stores-placeholder title="Shops and Rewards">
        @for (activity of activities; track activity.name) {
          <ng-container [ngTemplateOutlet]="storeTemplate" [ngTemplateOutletContext]="activity" />
        }
      </app-basic-stores-placeholder>
    </div>
  </main>
</div>

<ng-template
  #storeTemplate
  let-name="name"
  let-src="src"
  let-click="click"
  let-closed="closed"
  let-notification="notification">
  <div
    class="col-3"
    (click)="click ? click() : true"
    [ngClass]="{
      'no-text-highlight': closed,
    }">
    <div class="w-100 h-100 pt-2 pb-2 position-relative card-tile">
      <app-image
        [source]="'./assets/resourses/imgs/' + src + '.png'"
        [alt]="name"
        imageClass="card-img-top image-75" />
      <span class="card-title banner">{{ name }}</span>
      <app-notification-marker [notificationType]="notification" />

      @if (closed) {
        <app-container-label [size]="25" />
      }
    </div>
  </div>
</ng-template>

@if (showDailyReward$ | async) {
  <app-daily-reward [closePopup]="showDailyReward"></app-daily-reward>
}
